---
import { Code } from "@astrojs/starlight/components";

const { src, component, /* showLink = true */ } = Astro.props;

const text = (await src).default as string;

let content = "";

if (component) {
  const lines = text.split("\n");
  const start = lines.indexOf(`  - name: ${component}`);
  const end = lines.findIndex((line, index) => index > start && line.startsWith("  - name: "));
  content = lines.slice(start, end).join("\n");
} else {
  content = text;
}
---

<!-- {
  showLink && (
    <p>
      This example's full <code>zarf.yaml</code> can be viewed at <a href={`/${linkBaseUrl}/#zarf.yaml`}>{linkBaseUrl}</a>
    </p>
  )
} -->

<Code code={content} lang="yaml" />
